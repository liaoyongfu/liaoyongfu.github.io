<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="加油！">
<meta property="og:type" content="website">
<meta property="og:title" content="liaoyf的博客">
<meta property="og:url" content="https://liaoyongfu.github.io/page/2/index.html">
<meta property="og:site_name" content="liaoyf的博客">
<meta property="og:description" content="加油！">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="liaoyf的博客">
<meta name="twitter:description" content="加油！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://liaoyongfu.github.io/page/2/"/>





  <title>liaoyf的博客</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9de8fd632ad583c841a2a4fa8c3f5bc4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">liaoyf的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一分耕耘一分收获</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/12/13/nodejs/使用node.js发送邮件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/13/nodejs/使用node.js发送邮件/" itemprop="url">使用node.js发送邮件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T15:20:57+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/12/13/nodejs/使用node.js发送邮件/" class="leancloud_visitors" data-flag-title="使用node.js发送邮件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="使用nodemailler发送邮件"><a href="#使用nodemailler发送邮件" class="headerlink" title="使用nodemailler发送邮件"></a>使用nodemailler发送邮件</h2><p>这里我们以使用qq邮箱发送邮件为例。</p>
<ol>
<li>安装nodemailer</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save nodemailer</div></pre></td></tr></table></figure>
<ol>
<li>使用</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">var nodemailer = require(&apos;nodemailer&apos;);</div><div class="line"></div><div class="line">var mailTransport = nodemailer.createTransport(&#123;</div><div class="line">    host: &apos;smtp.qq.com&apos;,  //服务器地址</div><div class="line">    port: 465,  //端口</div><div class="line">    auth: &#123;</div><div class="line">      user: &apos;xxx@qq.com&apos;,</div><div class="line">      pass: &apos;授权码&apos;  //注：这里需要是授权码（在设置-&gt;账户-&gt;POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务下“生成授权码”），而不是登录密码</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">  mailTransport.sendMail(&#123;</div><div class="line">    from: &apos;&quot;your name&quot; &lt;xxx@qq.com&gt;&apos;,</div><div class="line">    to: &apos;xxx@gmail.com&apos;,  //收件人地址</div><div class="line">    subject: &apos;测试邮件111&apos;,</div><div class="line">    text: &apos;测试内容哦11111！！！！！！！&apos;</div><div class="line">  &#125;, function(err)&#123;</div><div class="line">    if(err) console.error(&apos;发送失败:&apos;, err);</div><div class="line">    console.info(&apos;发送成功！&apos;);</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/11/01/react/React项目问题总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/01/react/React项目问题总结/" itemprop="url">React项目问题总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-01T10:17:10+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/11/01/react/React项目问题总结/" class="leancloud_visitors" data-flag-title="React项目问题总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="目前出现的问题"><a href="#目前出现的问题" class="headerlink" title="目前出现的问题"></a>目前出现的问题</h2><ol>
<li><p>需要定义很多初始化state变量？</p>
</li>
<li><p>表单编辑后点取消，重新从后台拿数据如果是null的时候它不会自动更新state？</p>
</li>
<li><p>组件复用：未编写PropTypes，如果写了有时候返回的字段是null的，怎么写PropTypes？</p>
</li>
<li><p>组件复用：如果组件自己处理内部逻辑，那外面的组件如何拿到组件里面的数据？</p>
</li>
<li><p>页面需要记住类似查询状态，如何简单有效的实现？使用高阶组件实现？如何做到不冲突？</p>
</li>
<li><p>提示框太难用了？</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *  * Created by liaoyf on 2017/11/1 0001.</div><div class="line"> */</div><div class="line">import React from &apos;react&apos;;</div><div class="line">import &apos;bootstrap&apos;;</div><div class="line">import &#123; render &#125; from &apos;react-dom&apos;;</div><div class="line">import v4 from &apos;uuid&apos;;</div><div class="line"></div><div class="line">class ModalTool&#123;</div><div class="line">    constructor(options)&#123;</div><div class="line">        this.options = &#123;</div><div class="line">            okText: &apos;确定&apos;,</div><div class="line">            cancelText: &apos;取消&apos;,</div><div class="line">            title: &apos;提示框&apos;,</div><div class="line">            okAutoClose: true,</div><div class="line">            cancelAutoClose: true,</div><div class="line">            bsStyle: null,</div><div class="line">            bsSize: &apos;&apos;,</div><div class="line">            subContent: &apos;&apos;,</div><div class="line">            customContent: &apos;&apos;,</div><div class="line">            closeBtn: true,</div><div class="line">            backdrop: true,</div><div class="line">            ...options</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        this.init();</div><div class="line">    &#125;</div><div class="line">    bindEvent()&#123;</div><div class="line">        let &#123; onOk, onCancel &#125; = this.options;</div><div class="line"></div><div class="line">        $(&apos;#&apos; + this.modalId + &apos; .btn-ok&apos;).unbind(&apos;click&apos;).on(&apos;click&apos;, function()&#123;</div><div class="line">            onOk &amp;&amp; onOk();</div><div class="line">        &#125;);</div><div class="line">        $(&apos;#&apos; + this.modalId + &apos; .btn-cancel&apos;).unbind(&apos;click&apos;).on(&apos;click&apos;, function()&#123;</div><div class="line">            onCancel &amp;&amp; onCancel();</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    closeModal()&#123;</div><div class="line">        $(&apos;#&apos; + this.modalId ).modal(&apos;hide&apos;);</div><div class="line">    &#125;</div><div class="line">    init()&#123;</div><div class="line">        // $(&apos;.modalBox&apos;).remove();</div><div class="line">        $(&apos;.modal-backdrop&apos;).remove();</div><div class="line">        let &#123; title, content, okText, closeBtn, cancelText, okAutoClose, cancelAutoClose, bsStyle, bsSize, subContent, customContent, backdrop &#125; = this.options;</div><div class="line">        if(bsStyle)&#123;</div><div class="line">            content = (</div><div class="line">                &lt;dl className=&#123;`modal-state-show $&#123;bsStyle === &apos;warning&apos; ? &apos;state-error&apos; : bsStyle === &apos;success&apos; ? &apos;state-success&apos; : &apos;&apos;&#125;`&#125;&gt;</div><div class="line">                    &lt;dt className=&quot;state-ico&quot;&gt;&lt;i className=&quot;fa&quot;&gt;&lt;/i&gt;&lt;/dt&gt;</div><div class="line">                    &lt;dd className=&quot;state-text&quot;&gt;&#123;content&#125;&lt;/dd&gt;</div><div class="line">                    &#123;subContent &amp;&amp; &lt;dd className=&quot;state-info&quot;&gt;&#123;subContent&#125;&lt;/dd&gt;&#125;</div><div class="line">                    &#123;customContent &amp;&amp; &lt;dd&gt;&lt;p&gt;&#123;customContent&#125;&lt;/p&gt;&lt;/dd&gt;&#125;</div><div class="line">                &lt;/dl&gt;</div><div class="line">            );</div><div class="line">        &#125;else if(!React.isValidElement(content))&#123;</div><div class="line">            content = (</div><div class="line">                &lt;div className=&quot;text-vertical-wrap&quot;&gt;</div><div class="line">                    &lt;p className=&quot;text-center text-vertical&quot;&gt;&#123;content&#125;&lt;/p&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            );</div><div class="line">        &#125;</div><div class="line">        let modalId = `modal_$&#123;v4.v4()&#125;`;</div><div class="line">        let html =</div><div class="line">            `</div><div class="line">&lt;div class=&quot;modal fade modalBox&quot; id=&quot;$&#123;modalId&#125;&quot; tabIndex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;myModalLabel&quot;&gt;</div><div class="line">    &lt;div class=&quot;$&#123;&apos;modal-dialog &apos; + (bsSize ? &apos;modal-&apos; + bsSize : (bsStyle ? &apos;modal-sm&apos; : &apos;&apos;))&#125;&quot; role=&quot;document&quot;&gt;</div><div class="line">        &lt;div class=&quot;modal-content&quot;&gt;</div><div class="line">            &lt;div class=&quot;modal-header&quot;&gt;</div><div class="line">                $&#123;closeBtn ? `&lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;` : &apos;&apos;&#125;</div><div class="line">                &lt;h4 class=&quot;modal-title&quot; id=&quot;myModalLabel&quot;&gt;$&#123;title&#125;&lt;/h4&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class=&quot;body-inset modal-body&quot; id=&quot;modalBoxBody&quot;&gt;</div><div class="line">                </div><div class="line">            &lt;/div&gt;</div><div class="line">            &lt;div class=&quot;modal-footer&quot;&gt;</div><div class="line">                $&#123;okText ? `&lt;button type=&quot;button&quot; class=&quot;btn btn-primary btn-ok&quot; $&#123;okAutoClose &amp;&amp; `data-dismiss=&quot;modal&quot;`&#125;&gt;$&#123;okText&#125;&lt;/button&gt;` : &apos;&apos;&#125;</div><div class="line">                $&#123;cancelText ? `&lt;button type=&quot;button&quot; class=&quot;btn btn-default btn-cancel&quot; $&#123;cancelAutoClose &amp;&amp; `data-dismiss=&quot;modal&quot;`&#125;&gt;$&#123;cancelText&#125;&lt;/button&gt;` : &apos;&apos;&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">            `;</div><div class="line">        $(&apos;body&apos;).append(html);</div><div class="line">        this.modalId = modalId;</div><div class="line">        render(</div><div class="line">            content,</div><div class="line">            $(`#$&#123;modalId&#125; #modalBoxBody`)[0],</div><div class="line">            () =&gt; &#123;</div><div class="line">                $(`#$&#123;modalId&#125;`).modal(&#123;</div><div class="line">                    backdrop: backdrop</div><div class="line">                &#125;);</div><div class="line">                this.bindEvent();</div><div class="line">            &#125;</div><div class="line">        );</div><div class="line">        return $(`#$&#123;modalId&#125;`);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default ModalTool;</div></pre></td></tr></table></figure>
</li>
<li><p>需要封装常用的对象或数组操作工具方法</p>
</li>
<li><p>表单使用体验太差：需要编写一大推标签；需要手动编写value和onChange；表单校验需要改善</p>
</li>
<li><p>npm 包依赖如何做到同步更新？npm安装依赖包经常报错？npm打包太慢，启动太慢？打包后的文件不会自动加入svn版本控制？</p>
<p> npm安装依赖包报：<br> <code>npm ERR! unlink</code>的错误，解决方法：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rm (-rf) node_modules</div><div class="line">rm package-lock.json yarn.lock</div><div class="line">npm cache clear --force</div><div class="line">npm i -g npm # 5.4.1, as for now</div><div class="line">npm install --no-optional</div></pre></td></tr></table></figure>
<p> 最好打包时自动运行<code>npm update</code>操作：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//package.json</div><div class="line">&quot;script&quot;: &#123;</div><div class="line">    &quot;updater&quot;: &quot;npm update&quot;,</div><div class="line">    &quot;build&quot;: &quot;npm run updater&amp;&amp;webpack --env=prod --progress --profile --colors&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>如何做到公共thunk的合并？</p>
</li>
<li><p>front编译如何做到自动化？</p>
</li>
<li><p>process.env.NODE_ENV在编译后变成<code>I.env.NODE_ENV</code>？</p>
</li>
<li><p>如何require或import远程地址的文件？</p>
</li>
<li><p>脚手架运行时最好能判断当前的版本是不是最新的，如果不是就报错，这样能确保安装最新的脚手架？</p>
</li>
<li><p>热加载更新？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">import Container from &apos;./router&apos;;</div><div class="line"></div><div class="line">const render = (Component) =&gt; &#123;</div><div class="line">    ReactDOM.render(</div><div class="line">        &lt;Component/&gt;,</div><div class="line">        document.getElementById(&apos;root&apos;)</div><div class="line">    )   </div><div class="line">&#125;;</div><div class="line"></div><div class="line">render(Container);</div><div class="line"></div><div class="line">if (module.hot) &#123;</div><div class="line">    module.hot.accept(&apos;./router.js&apos;, () =&gt; &#123;</div><div class="line">        const NextRootContainer = require(&apos;./router&apos;).default;</div><div class="line">        render(NextRootContainer);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>js生成sourcemap方便调试？</p>
</li>
<li><p>组件间的样式在打包后会被相互影响？</p>
<p>使用<code>css module</code></p>
</li>
<li><p>如何解决ulynlist问题：basePath问题（貌似可以自己引）？</p>
</li>
<li><p>打包时如果output.publicPath为空字符串时会找不到字体图标的bug？</p>
<p>配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    test: /\.scss$/,</div><div class="line">    use: ExtractTextPlugin.extract(&#123;</div><div class="line">        //主要是加这一句</div><div class="line">        publicPath: &apos;../&apos;,</div><div class="line">        fallback: &apos;style-loader&apos;,</div><div class="line">        use: [</div><div class="line">            &#123;</div><div class="line">                loader: &apos;css-loader?sourceMap&apos;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                loader: &apos;resolve-url-loader&apos;</div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                loader: &apos;sass-loader?sourceMap&apos;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>样式想要抽成公用的，有两种方法：</p>
<p>如果只想在入口引用一个，则必须写到entry中；<br>如果在多个文件中引用？</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/10/31/react/React入门——简介/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/31/react/React入门——简介/" itemprop="url">React入门——简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-31T15:47:13+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/10/31/react/React入门——简介/" class="leancloud_visitors" data-flag-title="React入门——简介">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一、什么是React？</p>
<p>React是Facebook开源的一个用于构建用户界面的Javascript库，他不是一个框架，而是专注于MVC架构中的V，即视图。这使得React很容易和开发者已有的开发栈进行融合。React顺应了Web开发组件化的趋势。应用React时，你总是应该从UI出发抽象出不同的组件，然后像搭积木一样把它们拼装起来。</p>
<p>二、React能做什么？</p>
<p><img src="0006.png" alt="22"></p>
<p>补充：桌面应用程序（NW.js和Electron.js）</p>
<p>二、React全家桶 </p>
<ul>
<li>自身库： react.js、react-dom.js、add-ons</li>
<li>语法：ES5/ES6、JSX</li>
<li>构建工具：Fis3、webpack、babel</li>
<li>状态管理：Redux、Flux、react-redux、Immutable</li>
<li>路由：react-router、react-redux-router</li>
<li>日志：redux-logger</li>
<li>中间件：redux-thunk</li>
<li>主题：react-bootstrap</li>
<li>表单：redux-form</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/10/31/react/创建一个React项目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/31/react/创建一个React项目/" itemprop="url">创建一个React项目</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-31T15:47:13+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/10/31/react/创建一个React项目/" class="leancloud_visitors" data-flag-title="创建一个React项目">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>React由Facebook所写，由虚拟Dom、组件化获得广大前端开发者的青睐，下面我们通过一个示例来演示创建React项目的步骤：</p>
<h2 id="为什么用React"><a href="#为什么用React" class="headerlink" title="为什么用React"></a>为什么用<code>React</code></h2><p>React解决了创建大型项目性能以及复用性问题，React可以有两种写法：</p>
<p><em>使用React.createClass语法</em></p>
<pre><code>var HelloComponent = React.createClass({
      render: function() {
        return (
              &lt;div className=&quot;hello&quot;&gt;
                Hello, world!
              &lt;/div&gt;
        );
      }
});
</code></pre><p><em>使用ES6语法</em></p>
<pre><code>class HelloComponent extends React.Component {
  render() {
    return (
      &lt;div className=&quot;hello&quot;&gt;
        Hello, world!
      &lt;/div&gt;
    );
  }
}
</code></pre><h2 id="创建React项目"><a href="#创建React项目" class="headerlink" title="创建React项目"></a>创建React项目</h2><ol>
<li>安装<code>Node.js</code>和<code>NPM</code>，然后运行<code>npm init</code>创建一个<code>package.json</code>文件.</li>
<li>在控制台中运行：<code>npm install react react-dom babel-core babel-loader babel-preset-es2015 babel-preset-react webpack webpack-dev-server --save</code></li>
<li>创建<code>webpack.config.js</code>配置文件，这个的作用是帮我们打包资源，转换JSX为JS文件、合并、压缩、编译等等等。。。</li>
</ol>
<p>一个简单的webpack.config.js大致如下：</p>
<pre><code>var debug = process.env.NODE_ENV !== &quot;production&quot;;
var webpack = require(&apos;webpack&apos;);
var path = require(&apos;path&apos;);

module.exports = {
  context: path.join(__dirname, &quot;src&quot;),
  devtool: debug ? &quot;inline-sourcemap&quot; : null,
  entry: &quot;./js/App.js&quot;,
  devServer: {
    inline: true,
    port: 3333
  },
  module: {
    loaders: [
      {
        test: /\.jsx?$/,
        exclude: /(node_modules|bower_components)/,
        loader: &apos;babel-loader&apos;,
        query: {
          presets: [&apos;react&apos;, &apos;es2015&apos;],
          plugins: [&apos;react-html-attrs&apos;, &apos;transform-class-properties&apos;, &apos;transform-decorators-legacy&apos;],
        }
      }
    ]
  },
  output: {
    path: __dirname + &quot;/src/&quot;,
    filename: &quot;bundle.min.js&quot;
  },
  plugins: debug ? [] : [
    new webpack.optimize.DedupePlugin(),
    new webpack.optimize.OccurenceOrderPlugin(),
    new webpack.optimize.UglifyJsPlugin({ mangle: false, sourcemap: false }),
  ],
};
</code></pre><p>程序的入口通过<code>entry</code>设置，即页面第一次加载运行的文件，Webpack将把所有的JS和JSX文件到文件的输出对象，通过<code>devServer</code>设置webpack开发服务器为内联，并设置端口为<code>3333</code>，在<code>module</code>配置中，我们配置<code>babel</code>转换规则：使用<code>react</code>和<code>es2015</code>,plugins增加了类的属性和装饰器的功能。</p>
<h3 id="热加载"><a href="#热加载" class="headerlink" title="热加载"></a>热加载</h3><p>首先安装热加载模块：</p>
<pre><code>npm install --save-dev babel-preset-react-hmre
</code></pre><p>然后加到配置中：</p>
<pre><code>....
query: {
  presets: [&apos;react&apos;, &apos;es2015&apos;, &apos;react-hmre&apos;],
  plugins: [&apos;react-html-attrs&apos;, &apos;transform-class-properties&apos;, &apos;transform-decorators-legacy&apos;],
}
</code></pre><p>另一个选择是安装<code>react-hot-loader</code>然后添加<code>react-hot</code>到<code>webpack.config.js</code>配置中：</p>
<pre><code>...
loader: [&apos;babel-loader&apos;, &apos;react-hot&apos;]
...
</code></pre><p>为了运行项目更简单，我们一般会使用package.json的命令：</p>
<pre><code>{
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node_modules/.bin/webpack-dev-server --progress --inline --hot&quot;,
  }
}
</code></pre><p>注意：我们命令中添加了<code>--hot</code>，这个启动了热加载模式.</p>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>路由是一个应用非常重要的一部分，在React中比较受欢迎的莫属<code>React Router</code>了，事实上，很多开发者认为它就是React官方版的路由，当然，你得先安装它：</p>
<pre><code>npm install --save react-router
</code></pre><p>一个简单的示例看起来是这样子的：</p>
<pre><code>import React from &apos;react&apos;;
import { render } from &apos;react-dom&apos;;
import { browserHistory, Router, Route, IndexRoute } from &apos;react-router&apos;

import App from &apos;../components/App&apos;
import Home from &apos;../components/Home&apos;
import About from &apos;../components/About&apos;
import Features from &apos;../components/Features&apos;

render(
  &lt;Router history={browserHistory}&gt;
    &lt;Route path=&apos;/&apos; component={App}&gt;
      &lt;IndexRoute component={Home} /&gt;
      &lt;Route path=&apos;about&apos; component={About} /&gt;
      &lt;Route path=&apos;features&apos; component={Features} /&gt;
    &lt;/Route&gt;
  &lt;/Router&gt;,
  document.getElementById(&apos;app&apos;)
)
</code></pre><h2 id="国际化-I18N"><a href="#国际化-I18N" class="headerlink" title="国际化(I18N)"></a>国际化(I18N)</h2><p>通过<code>react-intl</code>你可以很轻松地实现国际化，它支持超过150中不同语言，默认是英文，呃~</p>
<h2 id="权限认证"><a href="#权限认证" class="headerlink" title="权限认证"></a>权限认证</h2><p>Authentication is an important part of any application. The best way to do user authentication for single page apps is via JSON Web Tokens (JWT). A typical authentication flow is this:</p>
<ul>
<li>A user signs up/logs in, generate JWT token and return it to the client</li>
<li>Store the JWT token on the client and send it via headers/query parameters for future requests</li>
</ul>
<p>A comprehensive example of adding authentication to a ReactJS app is here. Using Redux? Here is a good example of setting up authentication in your ReactJS application.</p>
<h2 id="数据持久化"><a href="#数据持久化" class="headerlink" title="数据持久化"></a>数据持久化</h2><p>Without a backend, you can persist data in your Single Page App by using Firebase. In a Reactjs app, all you simply need is ReactFire. It is a ReactJS mixin for easy Firebase integration. With ReactFire, it only takes a few lines of JavaScript to integrate Firebase data into React apps via the ReactFireMixin</p>
<pre><code>npm install --save reactfire react firebase
</code></pre><p>TodoList Example</p>
<pre><code>import React from &apos;react&apos;;

class TodoList extends React.Component {
  render() {
    var _this = this;
    var createItem = (item, index) =&gt; {
      return (
        &lt;li key={ index }&gt;
          { item.text }
          &lt;span onClick={ _this.props.removeItem.bind(null, item[&apos;.key&apos;]) }
                style=&gt;
            X
          &lt;/span&gt;
        &lt;/li&gt;
      );
    };

    return &lt;ul&gt;{ this.props.items.map(createItem) }&lt;/ul&gt;;
  }
}

class TodoApp extends React.Component {
  getInitialState() {
    return {
      items: [],
      text: &apos;&apos;
    };
  }

  componentWillMount() {
    this.firebaseRef = firebase.database().ref(&apos;todoApp/items&apos;);
    this.firebaseRef.limitToLast(25).on(&apos;value&apos;, function(dataSnapshot) {
      var items = [];
      dataSnapshot.forEach(childSnapshot =&gt; {
        const item = childSnapshot.val();
        item[&apos;.key&apos;] = childSnapshot.key;
        items.push(item);
      });

      this.setState({
        items: items
      });
    }.bind(this));
  }

  componentWillUnmount() {
    this.firebaseRef.off();
  }

  onChange(e) {
    this.setState({text: e.target.value});
  }

  removeItem(key) {
    var firebaseRef = firebase.database().ref(&apos;todoApp/items&apos;);;
    firebaseRef.child(key).remove();
  }

  handleSubmit(e) {
    e.preventDefault();
    if (this.state.text &amp;&amp; this.state.text.trim().length !== 0) {
      this.firebaseRef.push({
        text: this.state.text
      });
      this.setState({
        text: &apos;&apos;
      });
    }
  }

  render() {
    return (
      &lt;div&gt;
        &lt;TodoList items={ this.state.items } removeItem={ this.removeItem } /&gt;
        &lt;form onSubmit={ this.handleSubmit }&gt;
          &lt;input onChange={ this.onChange } value={ this.state.text } /&gt;
          &lt;button&gt;{ &apos;Add #&apos; + (this.state.items.length + 1) }&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    );
  }
}

ReactDOM.render(&lt;TodoApp /&gt;, document.getElementById(&apos;todoApp&apos;));
</code></pre><p>More information about persisting your data using ReactFire <a href="https://github.com/firebase/reactfire/blob/master/docs/quickstart.md" target="_blank" rel="external">here</a>.</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>Most projects become a mountain of spaghetti code at some point during development due to lack of solid tests or no tests at all. ReactJS apps are no different, but this can be avoided if you know some core principles. When writing tests for ReactJS code, it is helpful to pull out any functionality that doesn’t have to do with any UI components into separate modules, so that they can be tested separately. Tools for unit testing those functionalities are mocha, expect, chai, jasmine.</p>
<p>Testing becomes tricky in a ReactJS application when you have to deal with components. How do you test stateless components? How do you test components with state? Now, ReactJS provides a nice set of test utilities that allow us to inspect and examine the components we build. A particular concept worthy of mention is Shallow Rendering. Instead of rendering into a DOM the idea of shallow rendering is to instantiate a component and get the result of its render method. You can also check its props and children and verify they work as expected. More information here.</p>
<p>Facebook uses Jest to test React applications. AirBnB uses Enzyme. When bootstrapping your ReactJS application, you can set up any of these awesome tools to implement testing.</p>
<h2 id="脚手架和模板"><a href="#脚手架和模板" class="headerlink" title="脚手架和模板"></a>脚手架和模板</h2><p>A lot of tools have been mentioned in this post in relation to setting up different parts of a ReactJS app. If you don’t intend writing your app from scratch, there are lots of generators and boilerplates that tie all these tools together to give you a great starting point for your app. One fantastic example is React Starter Kit. It has a Yeoman generator. It’s an isomorphic web app boilerplate that contains almost everything you need to build a ReactJS app. Another boilerplate is React Static boilerplate, it helps you build a web app that can be hosted directly from CDNs like Firebase and Github Pages. Other alternatives are React redux starter kit and React webpack generator. Recently, a nice and effective tool called create-react-app was released by the guys at Facebook. It’s a CLI tool that helps create React apps with no build configuration!</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>There are several tools that will help bootstrap your React app, we looked at a couple that we consider quite good and will have your application up and running in no time. But feel free to search for your own tools, and if you think that we are missing something, let us know in the comments. Setting up a React project should be painless!</p>
<p>“Setting up a React project should be painless!”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/10/31/css/css样式遇到的坑/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/31/css/css样式遇到的坑/" itemprop="url">css样式遇到的坑</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-31T15:38:57+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/10/31/css/css样式遇到的坑/" class="leancloud_visitors" data-flag-title="css样式遇到的坑">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="bootstrap-datetime-picker在模态框中会随着页面滚动而错位"><a href="#bootstrap-datetime-picker在模态框中会随着页面滚动而错位" class="headerlink" title="bootstrap-datetime-picker在模态框中会随着页面滚动而错位"></a>bootstrap-datetime-picker在模态框中会随着页面滚动而错位</h2><p>解决方法：在<code>options</code>中增加<code>container: &#39;#modalId .modal-dialog&#39;</code>，默认的<code>container</code>是<code>body</code>，所以要改成<code>.modal-dialog</code>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/10/12/nodejs/express入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/12/nodejs/express入门/" itemprop="url">express入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-12T11:18:46+08:00">
                2017-10-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/10/12/nodejs/express入门/" class="leancloud_visitors" data-flag-title="express入门">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="配置handlebars"><a href="#配置handlebars" class="headerlink" title="配置handlebars"></a>配置handlebars</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">//须安装express-handlebars</div><div class="line">var exhbs = require(&apos;express-handlebars&apos;);</div><div class="line">var index = require(&apos;./routes/index&apos;);</div><div class="line">var users = require(&apos;./routes/users&apos;);</div><div class="line"></div><div class="line">var app = express();</div><div class="line"></div><div class="line">// view engine setup，这边名称如果为.hbs，则文件命名结尾也是.hbs（extname无效？）</div><div class="line">app.engine(&apos;.hbs&apos;, exhbs(&#123;</div><div class="line">    extname: &apos;.hbs&apos;</div><div class="line">&#125;));</div><div class="line">app.set(&apos;views&apos;, path.join(__dirname, &apos;views&apos;));</div><div class="line">app.set(&apos;view engine&apos;, &apos;.hbs&apos;);</div></pre></td></tr></table></figure>
<h2 id="使用supervisor进行热部署"><a href="#使用supervisor进行热部署" class="headerlink" title="使用supervisor进行热部署"></a>使用supervisor进行热部署</h2><p>安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g supervisor</div></pre></td></tr></table></figure>
<p>如果你使用的是 Linux 或 Mac，直接键入上面的命令很可能会有权限错误。原因是 npm需要把 supervisor 安装到系统目录，需要管理员授权，可以使用 sudo npm install -g supervisor 命令来安装。</p>
<p>接下来，更改pcakge.json中的<code>start</code>字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;start&quot;: &quot;supervisor bin/www&quot;</div></pre></td></tr></table></figure>
<p>之后运行<code>npm start</code>既可，命令行窗口会显示启动成功信息，即开启了代码监听。</p>
<h2 id="开放API"><a href="#开放API" class="headerlink" title="开放API"></a>开放API</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var router = express.Router();</div><div class="line">var mysql = require(&apos;mysql&apos;);</div><div class="line">var conncection = mysql.createConnection(&#123;</div><div class="line">    host: &apos;localhost&apos;,</div><div class="line">    user: &apos;root&apos;,</div><div class="line">    password: &apos;*****&apos;,</div><div class="line">    database: &apos;test&apos;,</div><div class="line">    port: 3306</div><div class="line">&#125;);</div><div class="line">conncection.connect();</div><div class="line"></div><div class="line">router.get(&apos;/getFamilyList&apos;, function(req, res, next)&#123;</div><div class="line">    conncection.query(&apos;select * from family&apos;, function(err, results, fields)&#123;</div><div class="line">        if(err) throw err;</div><div class="line">        res.json(results);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">router.get(&apos;/getFamilyById&apos;, function (req, res, next) &#123;</div><div class="line">    conncection.query(&apos;select * from family where id=?&apos;, [req.query.id], function(err, results, fields)&#123;</div><div class="line">        if(err) throw err;</div><div class="line">        res.json(results[0]);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">router.post(&apos;/updateFamilyById&apos;, function (req, res, next) &#123;</div><div class="line">    conncection.query(&apos;update family set name=?,age=? where id=?&apos;, [req.body.name, req.body.age, req.body.id], function(err, results, fields)&#123;</div><div class="line">        if(err) throw err;</div><div class="line">        res.json(&#123;</div><div class="line">            status: true</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">module.exports = router;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/09/29/react/React 16新增功能/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/29/react/React 16新增功能/" itemprop="url">React 16新增功能</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-29T15:19:23+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/09/29/react/React 16新增功能/" class="leancloud_visitors" data-flag-title="React 16新增功能">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="官网介绍"><a href="#官网介绍" class="headerlink" title="官网介绍"></a>官网介绍</h2><p><a href="https://facebook.github.io/react/blog/2017/09/26/react-v16.0.html" target="_blank" rel="external">https://facebook.github.io/react/blog/2017/09/26/react-v16.0.html</a></p>
<h2 id="render函数不必在包一层元素"><a href="#render函数不必在包一层元素" class="headerlink" title="render函数不必在包一层元素"></a>render函数不必在包一层元素</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  // No need to wrap list items in an extra element!</div><div class="line">  return [</div><div class="line">    // Don&apos;t forget the keys :)</div><div class="line">    &lt;li key=&quot;A&quot;&gt;First item&lt;/li&gt;,</div><div class="line">    &lt;li key=&quot;B&quot;&gt;Second item&lt;/li&gt;,</div><div class="line">    &lt;li key=&quot;C&quot;&gt;Third item&lt;/li&gt;,</div><div class="line">  ];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="更好的错误处理"><a href="#更好的错误处理" class="headerlink" title="更好的错误处理"></a>更好的错误处理</h2><p>以前的版本，如果子组件有报错整个组件本身直接不渲染，而现在可以通过<code>componentDidCatch</code>捕获错误信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">class ErrorBoundary extends React.Component &#123;</div><div class="line">    constructor(props) &#123;</div><div class="line">        super(props);</div><div class="line">        this.state = &#123; error: null, errorInfo: null &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    componentDidCatch(error, errorInfo) &#123;</div><div class="line">        // Catch errors in any components below and re-render with error message</div><div class="line">        this.setState(&#123;</div><div class="line">            error: error,</div><div class="line">            errorInfo: errorInfo</div><div class="line">        &#125;)</div><div class="line">        // You can also log error messages to an error reporting service here</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">        if (this.state.errorInfo) &#123;</div><div class="line">            // Error path</div><div class="line">            return (</div><div class="line">                &lt;div&gt;</div><div class="line">                    &lt;h2&gt;Something went wrong.&lt;/h2&gt;</div><div class="line">                    &lt;details style=&#123;&#123; whiteSpace: &apos;pre-wrap&apos; &#125;&#125;&gt;</div><div class="line">                        &#123;this.state.error &amp;&amp; this.state.error.toString()&#125;</div><div class="line">                        &lt;br /&gt;</div><div class="line">                        &#123;this.state.errorInfo.componentStack&#125;</div><div class="line">                    &lt;/details&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            );</div><div class="line">        &#125;</div><div class="line">        // Normally, just render children</div><div class="line">        return this.props.children;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h2><p>现在可以通过<code>React.createPortal(&lt;SomeComponent/&gt;, document.getElementById(&#39;root&#39;))</code>的形式在react应用容器之外修改或增加DOM：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  // React does *not* create a new div. It renders the children into `domNode`.</div><div class="line">  // `domNode` is any valid DOM node, regardless of its location in the DOM.</div><div class="line">  return ReactDOM.createPortal(</div><div class="line">    this.props.children,</div><div class="line">    domNode,</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样对于像要创建模态框就很容易了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">class Overlay extends React.Component&#123;</div><div class="line">    constructor()&#123;</div><div class="line">        super();</div><div class="line"></div><div class="line">        this.overlayContainer = document.createElement(&apos;div&apos;);</div><div class="line">        document.body.appendChild(this.overlayContainer);</div><div class="line">    &#125;</div><div class="line">    componentWillUnmount()&#123;</div><div class="line">        document.body.removeChild(this.overlayContainer);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line">        return ReactDOM.createPortal(</div><div class="line">            &lt;div className=&quot;overlay&quot; style=&#123;&#123;position: &apos;absolute&apos;, top: 0, right: 0, bottom: 0, left: 0, background: &apos;rgba(0,0,0, 0.5)&apos;, color: &apos;#fff&apos;&#125;&#125;&gt;</div><div class="line">                &#123;this.props.children&#125;</div><div class="line">            &lt;/div&gt;,</div><div class="line">            this.overlayContainer</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Demo extends React.Component&#123;</div><div class="line">    constructor()&#123;</div><div class="line">        super();</div><div class="line"></div><div class="line">        this.state = &#123;</div><div class="line">            overlayActive: true</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">        return (</div><div class="line">            &lt;div&gt;</div><div class="line">                &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; this.setState(&#123;</div><div class="line">                    user: null</div><div class="line">                &#125;)&#125;&gt;Update&lt;/button&gt;</div><div class="line">                &#123;this.state.overlayActive &amp;&amp; (</div><div class="line">                    &lt;Overlay onClose=&#123;() =&gt; this.setState(&#123;overlayActive: false&#125;)&#125;&gt;</div><div class="line">                        hello modal!!!</div><div class="line">                        &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; this.setState(&#123;overlayActive: false&#125;)&#125;&gt;Close&lt;/button&gt;</div><div class="line">                    &lt;/Overlay&gt;</div><div class="line">                )&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="更好的服务端渲染"><a href="#更好的服务端渲染" class="headerlink" title="更好的服务端渲染"></a>更好的服务端渲染</h2><p>省略。。。</p>
<h2 id="支持自定义DOM属性"><a href="#支持自定义DOM属性" class="headerlink" title="支持自定义DOM属性"></a>支持自定义DOM属性</h2><p>以前是直接忽视无法识别的属性，而现在是直接渲染给DOM，这也直接节省了很多代码。</p>
<p>具体参考：<a href="https://facebook.github.io/react/blog/2017/09/08/dom-attributes-in-react-16.html" target="_blank" rel="external">https://facebook.github.io/react/blog/2017/09/08/dom-attributes-in-react-16.html</a></p>
<h2 id="文件减少"><a href="#文件减少" class="headerlink" title="文件减少"></a>文件减少</h2><ul>
<li><p>react is 5.3 kb (2.2 kb gzipped), down from 20.7 kb (6.9 kb gzipped).</p>
</li>
<li><p>react-dom is 103.7 kb (32.6 kb gzipped), down from 141 kb (42.9 kb gzipped).</p>
</li>
<li><p>react + react-dom is 109 kb (34.8 kb gzipped), down from 161.7 kb (49.8 kb gzipped).</p>
</li>
</ul>
<h2 id="MIT协议"><a href="#MIT协议" class="headerlink" title="MIT协议"></a>MIT协议</h2><p>妥协了…</p>
<h2 id="新的核心架构Fiber"><a href="#新的核心架构Fiber" class="headerlink" title="新的核心架构Fiber"></a>新的核心架构Fiber</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/09/29/react-native/react-native中FlatList的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/29/react-native/react-native中FlatList的使用/" itemprop="url">react-native中FlatList的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-29T10:18:53+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/09/29/react-native/react-native中FlatList的使用/" class="leancloud_visitors" data-flag-title="react-native中FlatList的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="https://medium.com/react-native-development/how-to-use-the-flatlist-component-react-native-basics-92c482816fe6" target="_blank" rel="external">https://medium.com/react-native-development/how-to-use-the-flatlist-component-react-native-basics-92c482816fe6</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>自从0.43版本以来，react-native新增了两个新的列表视图组件：<code>FlatList</code>以及<code>SectionList</code>，现在我们来看看<code>FlatList</code>组件的使用。</p>
<h2 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h2><p>在<code>FlatList</code>中有个比较重要的属性：<code>data</code>和<code>renderItem</code>属性，data为object数组，renderItem可以控制每个item的渲染规则。</p>
<p>这边的示例我们将会从<a href="https://randomuser.me/" target="_blank" rel="external">Random User Generator API</a>中拿，UI渲染将会使用<a href="https://github.com/react-native-training/react-native-elements" target="_blank" rel="external">react-native-elements</a>的组件。</p>
<p><a href="https://github.com/spencercarli/react-native-flatlist-demo" target="_blank" rel="external">点击查看完整源代码</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">//FlatListDemo.js</div><div class="line">import React, &#123; Component &#125; from &quot;react&quot;;</div><div class="line">import &#123; View, Text, FlatList &#125; from &quot;react-native&quot;;</div><div class="line"></div><div class="line">class FlatListDemo extends Component &#123;</div><div class="line">  constructor(props) &#123;</div><div class="line">    super(props);</div><div class="line"></div><div class="line">    this.state = &#123;</div><div class="line">      loading: false,</div><div class="line">      data: [],</div><div class="line">      page: 1,</div><div class="line">      seed: 1,</div><div class="line">      error: null,</div><div class="line">      refreshing: false,</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    this.makeRemoteRequest();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  makeRemoteRequest = () =&gt; &#123;</div><div class="line">    const &#123; page, seed &#125; = this.state;</div><div class="line">    const url = `https://randomuser.me/api/?seed=$&#123;seed&#125;&amp;page=$&#123;page&#125;&amp;results=20`;</div><div class="line">    this.setState(&#123; loading: true &#125;);</div><div class="line">    fetch(url)</div><div class="line">      .then(res =&gt; res.json())</div><div class="line">      .then(res =&gt; &#123;</div><div class="line">        this.setState(&#123;</div><div class="line">          data: page === 1 ? res.results : [...this.state.data, ...res.results],</div><div class="line">          error: res.error || null,</div><div class="line">          loading: false,</div><div class="line">          refreshing: false</div><div class="line">        &#125;);</div><div class="line">      &#125;)</div><div class="line">      .catch(error =&gt; &#123;</div><div class="line">        this.setState(&#123; error, loading: false &#125;);</div><div class="line">      &#125;);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    return (</div><div class="line">      &lt;View style=&#123;&#123; flex: 1, alignItems: &quot;center&quot;, justifyContent: &quot;center&quot; &#125;&#125;&gt;</div><div class="line">        &lt;Text&gt;Coming soon...&lt;/Text&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default FlatListDemo;</div></pre></td></tr></table></figure>
<p>然后外边就可以使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">import FlatList from &apos;./FlatListDemo.js&apos;;</div><div class="line">import React from &apos;react&apos;;</div><div class="line">import &#123; List, ListItem &#125; from &apos;react-native-elements&apos;;</div><div class="line"></div><div class="line">class AwesomeProject extends React.Component&#123;</div><div class="line">    render()&#123;</div><div class="line">        &lt;List&gt;</div><div class="line">            &lt;FlatList</div><div class="line">                data=&#123;this.state.data&#125;</div><div class="line">                renderItem=&#123;(&#123; item &#125;) =&gt; (</div><div class="line">                  &lt;ListItem</div><div class="line">                    roundAvatar</div><div class="line">                    title=&#123;`$&#123;item.name.first&#125; $&#123;item.name.last&#125;`&#125;</div><div class="line">                    subtitle=&#123;item.email&#125;</div><div class="line">                    avatar=&#123;&#123; uri: item.picture.thumbnail &#125;&#125;</div><div class="line">                    keyExtractor=&#123;item =&gt; item.email&#125;</div><div class="line">                  /&gt;</div><div class="line">                )&#125;</div><div class="line">            /&gt;</div><div class="line">        &lt;/List&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>效果图如下：</p>
<p><img src="../../images/1-wxQVmFfaj-wSlBCL5oq2Jw.png" alt="demo"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/08/02/react/React高阶组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/react/React高阶组件/" itemprop="url">React高阶组件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-02T15:35:43+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/08/02/react/React高阶组件/" class="leancloud_visitors" data-flag-title="React高阶组件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>链接：<a href="https://zhuanlan.zhihu.com/p/24776678?group_id=802649040843051008" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/24776678?group_id=802649040843051008</a></p>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>这篇文章主要面向想要使用 HOC（Higher Order Component，高阶组件） 模式的进阶开发者。如果你是 React 新手，建议你从阅读 React 的文档开始。</p>
<p>高阶组件是一种很好的模式，很多 React 库已经证明了其价值。这篇文章中我们将会详细的讲解什么是 HOC，你能用它做什么，它有哪些局限，如何实现它。</p>
<p>在附录中有一些相关的话题，可能不是 HOC 的核心，但是我认为应该提到。</p>
<p>这篇文章尽量做到详尽无遗，如果你发现任何遗漏的，请提出来，我会做出必要的改动。</p>
<p>这篇文章假设你已经了解 ES6。</p>
<p>让我们开始吧！</p>
<h2 id="什么是高阶组件？"><a href="#什么是高阶组件？" class="headerlink" title="什么是高阶组件？"></a>什么是高阶组件？</h2><blockquote>
<p>高阶组件就是一个 React 组件包裹着另外一个 React 组件</p>
</blockquote>
<p>这种模式通常使用函数来实现，基本上是一个类工厂（是的，一个类工厂！），它的函数签名可以用类似 haskell 的伪代码表示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hocFactory:: W: React.Component =&gt; E: React.Component</div></pre></td></tr></table></figure>
<p>其中 W (WrappedComponent) 指被包裹的 React.Component，E (EnhancedComponent) 指返回类型为 React.Component 的新的 HOC。</p>
<p>我们有意模糊了定义中“包裹”的概念，因为它可能会有以下两种不同的含义之一：</p>
<ul>
<li><p>Props Proxy： HOC 对传给 WrappedComponent W 的 porps 进行操作;</p>
</li>
<li><p>Inheritance Inversion： HOC 继承 WrappedComponent W。</p>
</li>
</ul>
<p>（译注：原作者在评论中提到希望对 Props Proxy 和 Inheritance Inversion 不做翻译，故保留原文）</p>
<p>我们会深入地探究这两种模式。</p>
<h2 id="HOC-工厂的实现方法"><a href="#HOC-工厂的实现方法" class="headerlink" title="HOC 工厂的实现方法"></a>HOC 工厂的实现方法</h2><p>这一节我们将会研究 React 中两种 HOC 的实现方法：Props Proxy (PP) and Inheritance Inversion (II)。两种方法都可以操作 WrappedComponent。</p>
<h3 id="Props-Proxy"><a href="#Props-Proxy" class="headerlink" title="Props Proxy"></a>Props Proxy</h3><p>Props Proxy (PP) 的最简实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function ppHOC(WrappedComponent) &#123;  </div><div class="line">  return class PP extends React.Component &#123;    </div><div class="line">    render() &#123;      </div><div class="line">      return &lt;WrappedComponent &#123;...this.props&#125;/&gt;    </div><div class="line">    &#125;  </div><div class="line">  &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里主要是 HOC 在 render 方法中 返回 了一个 WrappedComponent 类型的 React Element。我们还传入了 HOC 接收到的 props，这就是名字 Props Proxy 的由来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;WrappedComponent &#123;...this.props&#125;/&gt;</div><div class="line">// 等价于</div><div class="line">React.createElement(WrappedComponent, this.props, null)</div></pre></td></tr></table></figure>
<p>在 React 内部的一致化处理（reconciliation process）中，两者都创建了一个 React Element 用于渲染。如果你想了解关于 React Elements vs Components ，请看 Dan Abramov 的这篇文章，想了解一致化处理请参考文档。</p>
<p>（译注：一致化处理（reconciliation process）可理解为 React 内部将虚拟 DOM 同步更新到真实 DOM 的过程，包括新旧虚拟 DOM 的比较及计算最小 DOM 操作）</p>
<h3 id="使用-Props-Proxy-可以做什么？"><a href="#使用-Props-Proxy-可以做什么？" class="headerlink" title="使用 Props Proxy 可以做什么？"></a>使用 Props Proxy 可以做什么？</h3><ul>
<li>操作 props</li>
<li>通过 Refs 访问到组件实例</li>
<li>提取 state</li>
<li>用其他元素包裹 WrappedComponent</li>
</ul>
<h4 id="操作-props"><a href="#操作-props" class="headerlink" title="操作 props"></a>操作 props</h4><p>你可以读取、添加、编辑、删除传给 WrappedComponent 的 props。</p>
<p>当删除或者编辑重要的 props 时要小心，你可能应该通过命名空间（<strong><em>命名空间是什么鬼？</em></strong>）确保高阶组件的 props 不会破坏 WrappedComponent。</p>
<p>例子：添加新的 props。在这个应用中，当前登录的用户可以在 WrappedComponent 中通过 this.props.user 访问到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function ppHOC(WrappedComponent) &#123;</div><div class="line">  return class PP extends React.Component &#123;</div><div class="line">    render() &#123;</div><div class="line">      const newProps = &#123;</div><div class="line">        user: currentLoggedInUser</div><div class="line">      &#125;</div><div class="line">      return &lt;WrappedComponent &#123;...this.props&#125; &#123;...newProps&#125;/&gt;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="通过-Refs-访问到组件实例"><a href="#通过-Refs-访问到组件实例" class="headerlink" title="通过 Refs 访问到组件实例"></a>通过 Refs 访问到组件实例</h4><p>你可以通过引用（ref）访问到 this （WrappedComponent 的实例），但为了得到引用，WrappedComponent 还需要一个初始渲染，意味着你需要在 HOC 的 render 方法中返回 WrappedComponent 元素，让 React 开始它的一致化处理，你就可以得到 WrappedComponent 的实例的引用。</p>
<p>例子：如何通过 refs 访问到实例的方法和实例本身：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">function refsHOC(WrappedComponent) &#123;</div><div class="line">  return class RefsHOC extends React.Component &#123;</div><div class="line">    proc(wrappedComponentInstance) &#123;</div><div class="line">      wrappedComponentInstance.method()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">      const props = Object.assign(&#123;&#125;, this.props, &#123;ref: this.proc.bind(this)&#125;)</div><div class="line">      return &lt;WrappedComponent &#123;...props&#125;/&gt;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Ref 的回调函数会在 WrappedComponent 渲染时执行，你就可以得到 WrappedComponent 的引用。这可以用来读取/添加实例的 props ，调用实例的方法。</p>
<h4 id="提取-state"><a href="#提取-state" class="headerlink" title="提取 state"></a>提取 state</h4><p>你可以通过传入 props 和回调函数把 state 提取出来，类似于 smart component 与 dumb component。更多关于 <a href="http://link.zhihu.com/?target=https%3A//medium.com/%40dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0%23.o2qmm6j3h" target="_blank" rel="external">dumb and smart component</a>。</p>
<p>提取 state 的例子：提取了 input 的 value 和 onChange 方法。这个简单的例子不是很常规，但足够说明问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">function ppHOC(WrappedComponent) &#123;</div><div class="line">  return class PP extends React.Component &#123;</div><div class="line">    constructor(props) &#123;</div><div class="line">      super(props)</div><div class="line">      this.state = &#123;</div><div class="line">        name: &apos;&apos;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      this.onNameChange = this.onNameChange.bind(this)</div><div class="line">    &#125;</div><div class="line">    onNameChange(event) &#123;</div><div class="line">      this.setState(&#123;</div><div class="line">        name: event.target.value</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">      const newProps = &#123;</div><div class="line">        name: &#123;</div><div class="line">          value: this.state.name,</div><div class="line">          onChange: this.onNameChange</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      return &lt;WrappedComponent &#123;...this.props&#125; &#123;...newProps&#125;/&gt;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>你可以这样用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@ppHOC</div><div class="line">class Example extends React.Component &#123;</div><div class="line">  render() &#123;</div><div class="line">    return &lt;input name=&quot;name&quot; &#123;...this.props.name&#125;/&gt;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个 input 会自动成为受控input。</p>
<blockquote>
<p>更多关于常规的双向绑定 HOC 请点击 <a href="http://link.zhihu.com/?target=https%3A//github.com/franleplant/react-hoc-examples/blob/master/pp_state.js" target="_blank" rel="external">链接</a></p>
</blockquote>
<h4 id="用其他元素包裹-WrappedComponent"><a href="#用其他元素包裹-WrappedComponent" class="headerlink" title="用其他元素包裹 WrappedComponent"></a>用其他元素包裹 WrappedComponent</h4><p>为了封装样式、布局或别的目的，你可以用其它组件和元素包裹 WrappedComponent。基本方法是使用父组件（附录 B）实现，但通过 HOC 你可以得到更多灵活性。</p>
<p>例子：包裹样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function ppHOC(WrappedComponent) &#123;</div><div class="line">  return class PP extends React.Component &#123;</div><div class="line">    render() &#123;</div><div class="line">      return (</div><div class="line">        &lt;div style=&#123;&#123;display: &apos;block&apos;&#125;&#125;&gt;</div><div class="line">          &lt;WrappedComponent &#123;...this.props&#125;/&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      )</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Inheritance-Inversion"><a href="#Inheritance-Inversion" class="headerlink" title="Inheritance Inversion"></a>Inheritance Inversion</h2><p>Inheritance Inversion (II) 的最简实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function iiHOC(WrappedComponent) &#123;</div><div class="line">  return class Enhancer extends WrappedComponent &#123;</div><div class="line">    render() &#123;</div><div class="line">      return super.render()</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>你可以看到，返回的 HOC 类（Enhancer）继承了 WrappedComponent。之所以被称为 Inheritance Inversion 是因为 WrappedComponent 被 Enhancer 继承了，而不是 WrappedComponent 继承了 Enhancer。在这种方式中，它们的关系看上去被反转（inverse）了。</p>
<p>Inheritance Inversion 允许 HOC 通过 this 访问到 WrappedComponent，意味着它可以访问到 state、props、组件生命周期方法和 render 方法。</p>
<p>关于生命周期方法可以用来做什么，我不想细说，因为它是 React 的特性而不是 HOC 的特性。但请注意通过 II 你可以创建新的生命周期方法。为了不破坏 WrappedComponent，记得调用 super.[lifecycleHook]。</p>
<h3 id="一致化处理（Reconciliation-process）"><a href="#一致化处理（Reconciliation-process）" class="headerlink" title="一致化处理（Reconciliation process）"></a>一致化处理（Reconciliation process）</h3><p>开始之前我们先理清一些概念。</p>
<p>React 元素决定描述了在 React 执行一致化处理时它要渲染什么。</p>
<p>React 元素有两种类型：字符串和函数。字符串类型的 React 元素代表 DOM 节点，函数类型的 React 元素代表继承 React.Component 的组件。更多关于元素（Element）和组件（Component）请看<a href="http://link.zhihu.com/?target=https%3A//facebook.github.io/react/blog/2015/12/18/react-components-elements-and-instances.html" target="_blank" rel="external">这篇文章</a>。</p>
<p>函数类型的 React 元素会在一致化处理中被解析成一个完全由字符串类型 React 组件组成的树（而最后的结果永远是 DOM 元素）。</p>
<p>这很重要，意味着 Inheritance Inversion 的高阶组件不一定会解析完整子树</p>
<blockquote>
<p>Inheritance Inversion 的高阶组件不一定会解析完整子树</p>
</blockquote>
<p>这在学习渲染劫持（Render Highjacking）时非常重要。</p>
<h3 id="你可以用-Inheritance-Inversion-做什么？"><a href="#你可以用-Inheritance-Inversion-做什么？" class="headerlink" title="你可以用 Inheritance Inversion 做什么？"></a>你可以用 Inheritance Inversion 做什么？</h3><ul>
<li><p>渲染劫持（Render Highjacking）</p>
</li>
<li><p>操作 state</p>
</li>
</ul>
<h4 id="渲染劫持"><a href="#渲染劫持" class="headerlink" title="渲染劫持"></a>渲染劫持</h4><p>之所以被称为渲染劫持是因为 HOC 控制着 WrappedComponent 的渲染输出，可以用它做各种各样的事。</p>
<p>通过渲染劫持你可以：</p>
<ul>
<li>在由 render输出的任何 React 元素中读取、添加、编辑、删除 props</li>
<li>读取和修改由 render 输出的 React 元素树</li>
<li>有条件地渲染元素树</li>
<li>把样式包裹进元素树（就像在 Props Proxy 中的那样）</li>
</ul>
<p>*render 指 WrappedComponent.render 方法</p>
<blockquote>
<p>你不能编辑或添加 WrappedComponent 实例的 props，因为 React 组件不能编辑它接收到的 props，但你可以修改由 render 方法返回的组件的 props。</p>
</blockquote>
<p>就像我们刚才学到的，II 类型的 HOC 不一定会解析完整子树，意味着渲染劫持有一些限制。根据经验，使用渲染劫持你可以完全操作 WrappedComponent 的 render 方法返回的元素树。但是如果元素树包括一个函数类型的 React 组件，你就不能操作它的子组件了。（被 React 的一致化处理推迟到了真正渲染到屏幕时）</p>
<p>例1：条件渲染。当 this.props.loggedIn 为 true 时，这个 HOC 会完全渲染 WrappedComponent 的渲染结果。（假设 HOC 接收到了 loggedIn 这个 prop）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function iiHOC(WrappedComponent) &#123;</div><div class="line">  return class Enhancer extends WrappedComponent &#123;</div><div class="line">    render() &#123;</div><div class="line">      if (this.props.loggedIn) &#123;</div><div class="line">        return super.render()</div><div class="line">      &#125; else &#123;</div><div class="line">        return null</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>例2：修改由 render 方法输出的 React 组件树。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function iiHOC(WrappedComponent) &#123;</div><div class="line">  return class Enhancer extends WrappedComponent &#123;</div><div class="line">    render() &#123;</div><div class="line">      const elementsTree = super.render()</div><div class="line">      let newProps = &#123;&#125;;</div><div class="line">      if (elementsTree &amp;&amp; elementsTree.type === &apos;input&apos;) &#123;</div><div class="line">        newProps = &#123;value: &apos;may the force be with you&apos;&#125;</div><div class="line">      &#125;</div><div class="line">      const props = Object.assign(&#123;&#125;, elementsTree.props, newProps)</div><div class="line">      const newElementsTree = React.cloneElement(elementsTree, props, elementsTree.props.children)</div><div class="line">      return newElementsTree</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这个例子中，如果 WrappedComponent 的输出在最顶层有一个 input，那么就把它的 value 设为 “may the force be with you”。</p>
<p>你可以在这里做各种各样的事，你可以遍历整个元素树，然后修改元素树中任何元素的 props。这也正是样式处理库 Radium 所用的方法（案例分析一节中有更多关于 Radium 的信息）。</p>
<p>注：在 Props Proxy 中不能做到渲染劫持。</p>
<p>虽然通过 WrappedComponent.prototype.render 你可以访问到 render 方法，不过还需要模拟 WrappedComponent 的实例和它的 props，还可能亲自处理组件的生命周期，而不是交给 React。根据我的实验，这么做不值，你要是想做到渲染劫持你应该用 Inheritance Inversion 而不是 Props Proxy。记住，React 在内部处理了组件实例，你处理实例的唯一方法是通过 this 或者 refs。</p>
<h3 id="操作-state"><a href="#操作-state" class="headerlink" title="操作 state"></a>操作 state</h3><p>HOC 可以读取、编辑和删除 WrappedComponent 实例的 state，如果你需要，你也可以给它添加更多的 state。记住，这会搞乱 WrappedComponent 的 state，导致你可能会破坏某些东西。要限制 HOC 读取或添加 state，添加 state 时应该放在单独的命名空间里，而不是和 WrappedComponent 的 state 混在一起。</p>
<p>例子：通过访问 WrappedComponent 的 props 和 state 来做调试。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">export function IIHOCDEBUGGER(WrappedComponent) &#123;</div><div class="line">  return class II extends WrappedComponent &#123;</div><div class="line">    render() &#123;</div><div class="line">      return (</div><div class="line">        &lt;div&gt;</div><div class="line">          &lt;h2&gt;HOC Debugger Component&lt;/h2&gt;</div><div class="line">          &lt;p&gt;Props&lt;/p&gt; &lt;pre&gt;&#123;JSON.stringify(this.props, null, 2)&#125;&lt;/pre&gt;</div><div class="line">          &lt;p&gt;State&lt;/p&gt;&lt;pre&gt;&#123;JSON.stringify(this.state, null, 2)&#125;&lt;/pre&gt;</div><div class="line">          &#123;super.render()&#125;</div><div class="line">        &lt;/div&gt;</div><div class="line">      )</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里 HOC 用其他元素包裹着 WrappedComponent，还输出了 WrappedComponent 实例的 props 和 state。JSON.stringify 的小技巧是由 Ryan Florence 和 Michael Jackson 教我的。这个调试器完整的实现在这里。</p>
<h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><p>用 HOC 包裹了一个组件会使它失去原本 WrappedComponent 的名字，可能会影响开发和调试。</p>
<p>通常会用 WrappedComponent 的名字加上一些 前缀作为 HOC 的名字。下面的代码来自 React-Redux：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">HOC.displayName = `HOC($&#123;getDisplayName(WrappedComponent)&#125;)`</div><div class="line"></div><div class="line">//或</div><div class="line"></div><div class="line">class HOC extends ... &#123;</div><div class="line">  static displayName = `HOC($&#123;getDisplayName(WrappedComponent)&#125;)`</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>getDisplayName 函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function getDisplayName(WrappedComponent) &#123;</div><div class="line">  return WrappedComponent.displayName ||</div><div class="line">         WrappedComponent.name ||</div><div class="line">         ‘Component’</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>实际上你不用自己写，recompose 提供了这个函数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liaoyongfu.github.io/2017/08/02/javascript/js浅拷贝和深拷贝/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liaoyf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liaoyf的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/javascript/js浅拷贝和深拷贝/" itemprop="url">js浅拷贝和深拷贝</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-02T15:35:43+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/08/02/javascript/js浅拷贝和深拷贝/" class="leancloud_visitors" data-flag-title="js浅拷贝和深拷贝">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="javaScript的变量类型"><a href="#javaScript的变量类型" class="headerlink" title="javaScript的变量类型"></a>javaScript的变量类型</h2><p>（1）基本类型：</p>
<p>5种基本数据类型Undefined、Null、Boolean、Number 和 String，变量是直接按值存放的，存放在栈内存中的简单数据段，可以直接访问。</p>
<p>（2）引用类型：</p>
<p>存放在堆内存中的对象，变量保存的是一个指针，这个指针指向另一个位置。当需要访问引用类型（如对象，数组等）的值时，首先从栈中获得该对象的地址指针，然后再从堆内存中取得所需的数据。</p>
<blockquote>
<p>JavaScript存储对象都是存地址的，所以浅拷贝会导致 obj1 和obj2 指向同一块内存地址。改变了其中一方的内容，都是在原来的内存上做修改会导致拷贝对象和源对象都发生改变，而深拷贝是开辟一块新的内存地址，将原对象的各个属性逐个复制进去。对拷贝对象和源对象各自的操作互不影响。</p>
</blockquote>
<p>例如：数组拷贝</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//浅拷贝，双向改变,指向同一片内存空间</div><div class="line">var arr1 = [1, 2, 3];</div><div class="line">var arr2 = arr1;</div><div class="line">arr1[0] = &apos;change&apos;;</div><div class="line">console.log(&apos;shallow copy: &apos; + arr1 + &quot; );   //shallow copy: change,2,3</div><div class="line">console.log(&apos;shallow copy: &apos; + arr2 + &quot; );   //shallow copy: change,2,3</div></pre></td></tr></table></figure>
<h2 id="浅拷贝的实现"><a href="#浅拷贝的实现" class="headerlink" title="浅拷贝的实现"></a>浅拷贝的实现</h2>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/08/02/javascript/js浅拷贝和深拷贝/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="liaoyf" />
          <p class="site-author-name" itemprop="name">liaoyf</p>
           
              <p class="site-description motion-element" itemprop="description">加油！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">37</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/liaoyongfu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liaoyf</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("9LYFM8dS64BIEzTbmQtY4rvd-gzGzoHsz", "5aTlsc7dgozMlgNQQ6Ob7VBR");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
